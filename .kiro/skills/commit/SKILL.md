---
name: commit
description: "고품질 git 커밋 생성: 의도한 변경사항 검토/스테이징, 논리적 커밋 단위 분리, 명확한 커밋 메시지 작성 (Conventional Commits 필수). 커밋, 커밋 메시지 작성, 변경사항 스테이징, 여러 커밋으로 분리 요청 시 사용."
version: 1.0.0
user-invocable: true
---

# 작업 커밋

## 목표

리뷰하기 쉽고 안전하게 배포할 수 있는 커밋 생성:
- 의도한 변경사항만 포함
- 논리적으로 범위가 지정된 커밋 (필요시 분리)
- 무엇이 왜 변경되었는지 설명하는 커밋 메시지

## 확인할 입력값 (없으면 질문)

- 단일 커밋 vs 여러 커밋? (불확실하면: 관련 없는 변경사항이 있을 때 여러 개의 작은 커밋으로 기본 설정)
- 커밋 스타일: Conventional Commits 필수
- 규칙: 최대 subject 길이, 필수 scope 등

## 워크플로우 (체크리스트)

### 1) 스테이징 전 작업 트리 검사

```bash
git status
git diff              # unstaged
git diff --stat       # 변경사항이 많을 경우
```

### 2) 커밋 경계 결정 (필요시 분리)

분리 기준:
- 기능 vs 리팩토링
- 백엔드 vs 프론트엔드
- 포맷팅 vs 로직
- 테스트 vs 프로덕션 코드
- 의존성 업데이트 vs 동작 변경

한 파일에 변경사항이 섞여 있으면 patch 스테이징 계획.

### 3) 다음 커밋에 해당하는 것만 스테이징

```bash
# 혼합된 변경사항은 patch 스테이징 권장
git add -p

# hunk/파일 언스테이징
git restore --staged -p
git restore --staged <path>
```

### 4) 실제 커밋될 내용 검토

```bash
git diff --cached
```

**점검 사항:**
- [ ] 시크릿이나 토큰 없음
- [ ] 실수로 남긴 디버그 로깅 없음
- [ ] 관련 없는 포맷팅 변경 없음

### 5) 스테이징된 변경사항을 1-2문장으로 설명 (메시지 작성 전)

- "무엇이 변경되었나?" + "왜?"
- 깔끔하게 설명할 수 없다면, 커밋이 너무 크거나 섞여 있는 것 → 2단계로 돌아가기

### 6) 커밋 메시지 작성

**Conventional Commits (필수):**

```
type(scope): 짧은 요약

본문 (무엇/왜, 구현 일기 X)

푸터 (필요시 BREAKING CHANGE)
```

**규칙:**
- 여러 줄 메시지는 에디터 사용 권장: `git commit -v`
- scope는 거의 사용하지 않음 (breaking change, 대규모 리팩토링 시에만)

### 7) 최소한의 관련 검증 실행

다음 단계로 넘어가기 전 레포의 가장 빠른 의미 있는 검사 실행 (유닛 테스트, lint, 또는 빌드).

### 8) 작업 트리가 깨끗해질 때까지 다음 커밋 반복

---

## 결과물

제공할 것:
- 최종 커밋 메시지
- 커밋별 짧은 요약 (무엇/왜)
- 스테이징/검토에 사용한 명령어 (최소: `git diff --cached`, 실행한 테스트)

---

## Conventional Commits 타입

| 타입 | 설명 |
|------|------|
| `feat` | 새로운 기능 추가 |
| `fix` | 버그 수정 |
| `docs` | 문서 변경 |
| `wip` | 작업 진행 중 |
| `style` | 코드 스타일 변경 (포맷팅, 세미콜론 등) |
| `refactor` | 리팩토링 (기능 변경 없음) |
| `perf` | 성능 개선 |
| `test` | 테스트 추가/수정 |
| `build` | 빌드 시스템/외부 의존성 변경 |
| `ci` | CI 설정 변경 |
| `chore` | 기타 변경 (src/test 외 파일) |
| `revert` | 이전 커밋 되돌리기 |

---

## 중요 규칙

1. **커밋 메시지 먼저 보여주기** - "커밋할까요?" 만 묻지 말고, 항상 메시지 내용을 먼저 제시
2. **사용자 승인 후 실행** - 승인 없이 절대 커밋 실행 금지
3. **헤더 50자 제한** - 넘으면 줄이거나 다시 작성
4. **타입은 소문자** - `feat` O, `Feat` X
5. **명령형 사용** - "기능 추가" O, "기능을 추가함" X
