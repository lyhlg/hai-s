# 테이블오더 서비스 - 요구사항 정의서

## 서비스 비전

디지털 주문 시스템을 통해 고객에게는 편리한 주문 경험을, 매장 운영자에게는 효율적인 운영 환경을 제공하는 차세대 테이블오더 플랫폼

### 핵심 가치 제안

**고객 관점**
- 대기 시간 없는 즉시 주문
- 직관적이고 사용하기 쉬운 인터페이스

**매장 운영자 관점**
- 인건비 절감 및 운영 효율성 증대
- 실시간 주문 관리 및 모니터링

**시장 차별화**
- 다양한 업종에 적용 가능한 유연한 구조
- 직관적인 관리자 도구

---

## Intent Analysis

- **User Request**: 테이블오더 서비스 구축 (디지털 주문 시스템)
- **Request Type**: New Project (Greenfield)
- **Scope Estimate**: System-wide (백엔드 + 프론트엔드 2개 + DB)
- **Complexity Estimate**: Complex (멀티 매장, 실시간 통신, 세션 관리)

---

## 기술 스택

| 영역 | 기술 |
|------|------|
| 백엔드 | Node.js (Express) |
| 프론트엔드 (고객용) | React (Vite) - 브라우저 기반 웹UI |
| 프론트엔드 (관리자용) | React (Vite) |
| 데이터베이스 | MySQL |
| 실시간 통신 | SSE (Server-Sent Events) |
| 이미지 저장 | 로컬 파일 시스템 (추후 S3 전환 가능하도록 추상화) |
| 배포 환경 | 로컬 개발 환경 (MVP) |
| 레포 구조 | Turborepo 모노레포 (pnpm workspace) |

---

## 아키텍처 결정

- **멀티 매장 지원**: 여러 매장을 하나의 시스템에서 관리 (SaaS 구조)
- **프론트엔드 분리**: 고객용/관리자용 별도 React 앱
- **관리자 계정**: Seed 데이터로 초기 생성 (회원가입 없음)
- **고객 실시간 업데이트**: MVP에 포함 (SSE)

---

## Functional Requirements

### FR-1: 고객용 - 테이블 태블릿 자동 로그인 및 세션 관리
- 관리자가 1회 초기 설정 (매장 ID, 테이블 번호, 비밀번호)
- 로그인 정보 로컬 저장 후 자동 로그인
- 테이블 세션: 첫 주문 시작 ~ 이용 완료 처리까지

### FR-2: 고객용 - 메뉴 조회 및 탐색
- 메뉴 화면이 기본 화면
- 카테고리별 분류 및 표시
- 메뉴 상세: 메뉴명, 가격, 설명, 이미지
- 인기 메뉴 표기 (관리자가 수동 지정하는 "잘 팔리는 메뉴" 배지)
- 품절 메뉴 표기 (품절 배지 표시 + 주문 불가, 목록에는 노출)
- 카테고리 간 빠른 이동
- 카드 형태 레이아웃, 터치 친화적 (최소 44x44px)

### FR-3: 고객용 - 장바구니 관리
- 메뉴 추가/삭제, 수량 조절
- 총 금액 실시간 계산
- 장바구니 비우기 (수동)
- 클라이언트 측 로컬 저장 (새로고침 시 유지)
- 서버 전송은 주문 확정 시에만

### FR-4: 고객용 - 주문 생성
- 주문 내역 최종 확인 후 확정
- 성공 시: 주문 번호 5초 표시, 장바구니 비우기, 메뉴 화면으로 자동 리다이렉트
- 실패 시: 에러 메시지 표시, 장바구니 유지
- 주문 정보: 매장 ID, 테이블 ID, 메뉴 목록 (메뉴명, 수량, 단가), 총 금액, 세션 ID

### FR-5: 고객용 - 주문 내역 조회
- 현재 테이블 세션 주문만 표시 (매장 이용 완료 처리된 주문은 제외)
- 주문 시간 순 정렬
- 주문별: 주문 번호, 시각, 메뉴/수량, 금액, 상태
- 주문 상태 실시간 업데이트 (SSE)
- 페이지네이션 또는 무한 스크롤

### FR-6: 관리자용 - 매장 인증
- 매장 ID + 사용자명 + 비밀번호 로그인
- JWT 토큰 기반, 16시간 세션 유지
- 브라우저 새로고침 시 세션 유지
- 16시간 후 자동 로그아웃
- bcrypt 비밀번호 해싱
- 로그인 시도 제한

### FR-7: 관리자용 - 실시간 주문 모니터링
- SSE 기반 실시간 주문 목록 업데이트
- 테이블별 그리드/카드 레이아웃
- 각 카드: 총 주문액, 최신 주문 미리보기 (테이블 번호, 주문 번호, 주문 시각, 메뉴/수량 축약, 총 금액)
- 카드 클릭 시 전체 메뉴 목록 상세 보기
- 주문 상태 변경 (대기중/준비중/완료)
- 신규 주문 시각적 강조 (색상 변경, 애니메이션)
- 2초 이내 주문 표시
- 테이블별 필터링 기능

### FR-8: 관리자용 - 테이블 관리
- 테이블 초기 설정 (번호, 비밀번호, 16시간 세션)
- 주문 삭제 (확인 팝업, 총 주문액 재계산, 성공/실패 피드백)
- 테이블 세션 시작: 해당 테이블의 첫 주문 시점에 자동 시작
- 테이블 세션 종료 (이용 완료): 확인 팝업, 주문 내역 → 과거 이력 (OrderHistory), 총 주문액 리셋, 성공/실패 피드백
- 세션 종료 후 새 고객은 이전 주문 내역 없이 깨끗한 상태에서 시작
- 세션 ID로 주문 그룹화, 완료 시각 기록
- 과거 주문 내역 조회 (시간 역순, 날짜 필터링, 매장 이용 완료 시각 표시)
- 과거 내역 화면에서 "닫기" 버튼으로 대시보드 복귀

### FR-9: 관리자용 - 메뉴 관리
- CRUD: 메뉴명, 가격, 설명, 카테고리, 이미지 URL, 인기 메뉴 여부, 품절 여부
- 메뉴 노출 순서 조정
- 필수 필드 및 가격 범위 검증

### FR-10: 관리자용 - 일매출 정산
- 당일 총 매출액 표시
- 완료된 주문 기준 집계
- 날짜별 매출 조회 (날짜 선택)
- 테이블별 매출 내역 표시

---

## Non-Functional Requirements

### NFR-1: 성능
- SSE 주문 알림 2초 이내 전달
- 메뉴 조회 응답 시간 500ms 이내

### NFR-2: 보안
- JWT 토큰 기반 인증
- bcrypt 비밀번호 해싱
- 로그인 시도 제한

### NFR-3: 사용성
- 터치 친화적 UI (최소 44x44px 버튼)
- 직관적 시각적 계층 구조
- 장바구니 로컬 저장 (새로고침 유지)

### NFR-4: 확장성
- 멀티 매장 지원 구조
- 이미지 저장소 추상화 (로컬 → S3 전환 가능)

---

## 제외 범위 (Constraints)

- 결제 처리 (PG사 연동, 영수증, 환불, 포인트/쿠폰)
- 복잡한 인증 (OAuth, SNS, 2FA)
- 이미지 리사이징/최적화
- 알림 시스템 (푸시, SMS, 이메일, 소리)
- 주방 기능 (주방 전달, 재고 관리)
- 고급 기능 (분석, 매출 리포트, 직원 관리, 예약, 리뷰, 다국어)
- 외부 연동 (배달, POS, 소셜, 지도, 번역)

---

## MVP 개발 범위

### 핵심 기능 (필수)

**고객용**:
- 테이블 태블릿 자동 로그인 및 세션 관리
- 메뉴 조회
- 장바구니 관리
- 주문 생성 (5초 표시 후 자동 리다이렉트)
- 주문 내역 조회 (현재 세션만)

**관리자용**:
- 매장 인증 (16시간 세션)
- 실시간 주문 모니터링 (그리드 레이아웃, SSE)
- 테이블 관리 (초기 설정, 주문 삭제, 매장 이용 완료, 과거 내역 조회)

---

## 부록

### 용어 정의
- **MVP**: Minimum Viable Product (최소 기능 제품)
- **API**: Application Programming Interface (애플리케이션 프로그래밍 인터페이스)
- **UI/UX**: User Interface / User Experience (사용자 인터페이스 / 사용자 경험)
- **테이블 세션**: 특정 테이블에 고객이 앉아서 첫 주문 시작한 후부터 해당 테이블 이용 완료 처리까지의 시간. 세션 종료 후 다른 고객의 첫 주문 시작 시, 새로운 세션 시작.
- **SSE**: Server-Sent Events (서버에서 클라이언트로 실시간 단방향 데이터 전송)
- **JWT**: JSON Web Token (인증 토큰)
