# User Stories

> 분류: Domain Slice 기반 | 우선순위: MoSCoW

---

# Domain: 인증 (Authentication)

## US-1: 테이블 태블릿 자동 로그인 [Must]
**As a** 고객 (김지수/박영숙),
**I want** 테이블에 앉으면 별도 로그인 없이 바로 메뉴 화면을 볼 수 있기를,
**So that** 대기 시간 없이 즉시 주문을 시작할 수 있다.

**Acceptance Criteria:**
- 관리자가 초기 설정한 매장 ID, 테이블 번호, 비밀번호가 로컬에 저장된다
- 저장된 정보로 자동 로그인이 수행된다
- 로그인 성공 시 메뉴 화면이 표시된다

**Scenarios:**
```
Given 태블릿에 로그인 정보가 저장되어 있을 때
When 태블릿 브라우저를 열면
Then 자동 로그인되어 메뉴 화면이 표시된다
```
```
Given 저장된 로그인 정보가 유효하지 않을 때
When 자동 로그인을 시도하면
Then 관리자 초기 설정 화면이 표시된다
```

**Edge Cases:**
- 네트워크 끊김 시: 에러 메시지 표시 후 재시도
- 매장 ID가 변경된 경우: 초기 설정 화면으로 이동

**UI Hints:**
- 자동 로그인 중 로딩 인디케이터 표시
- 초기 설정 화면: 매장 ID, 테이블 번호, 비밀번호 입력 폼

---

## US-2: 관리자 매장 로그인 [Must]
**As a** 관리자 (이민호),
**I want** 매장 ID, 사용자명, 비밀번호로 로그인할 수 있기를,
**So that** 내 매장의 주문과 메뉴를 관리할 수 있다.

**Acceptance Criteria:**
- 매장 ID + 사용자명 + 비밀번호로 로그인한다
- JWT 토큰 발급, 16시간 세션 유지
- 브라우저 새로고침 시 세션 유지
- 16시간 후 자동 로그아웃
- bcrypt 해싱된 비밀번호 검증
- 로그인 시도 제한

**Scenarios:**
```
Given 유효한 매장 ID, 사용자명, 비밀번호를 입력했을 때
When 로그인 버튼을 클릭하면
Then JWT 토큰이 발급되고 주문 모니터링 대시보드가 표시된다
```
```
Given 로그인 후 16시간이 경과했을 때
When 다음 요청을 보내면
Then 자동 로그아웃되고 로그인 화면으로 이동한다
```
```
Given 5회 연속 로그인 실패했을 때
When 다시 로그인을 시도하면
Then 일정 시간 동안 로그인이 차단된다
```

**Edge Cases:**
- 브라우저 새로고침: 저장된 JWT로 세션 복원
- 동시 로그인: 허용 (여러 기기에서 접속 가능)

**UI Hints:**
- 매장 ID, 사용자명, 비밀번호 입력 폼
- 로그인 실패 시 남은 시도 횟수 표시

---

# Domain: 메뉴 (Menu)

## US-3: 메뉴 조회 및 탐색 [Must]
**As a** 고객 (김지수/박영숙),
**I want** 카테고리별로 메뉴를 탐색하고 상세 정보를 볼 수 있기를,
**So that** 원하는 메뉴를 쉽게 찾아 선택할 수 있다.

**Acceptance Criteria:**
- 메뉴 화면이 기본(홈) 화면이다
- 카테고리별 메뉴 분류 및 표시
- 메뉴 상세: 메뉴명, 가격, 설명, 이미지
- 인기 메뉴에 "잘 팔리는 메뉴" 배지 표시 (관리자가 수동 지정)
- 품절 메뉴에 "품절" 배지 표시 + 담기 버튼 비활성화 (목록에는 노출)
- 카테고리 간 빠른 이동 (탭 또는 스크롤)
- 카드 형태 레이아웃, 터치 친화적 (최소 44x44px)

**Scenarios:**
```
Given 메뉴 화면에 있을 때
When 카테고리 탭을 선택하면
Then 해당 카테고리의 메뉴 목록이 표시된다
```
```
Given 메뉴 카드를 볼 때
When 메뉴 카드를 터치하면
Then 메뉴명, 가격, 설명, 이미지가 포함된 상세 정보가 표시된다
```
```
Given 메뉴 목록에서
When 관리자가 인기 메뉴로 지정한 메뉴가 있으면
Then 해당 메뉴 카드에 "잘 팔리는 메뉴" 배지가 표시된다
```

**Edge Cases:**
- 메뉴 이미지 로딩 실패: placeholder 이미지 표시
- 메뉴가 0개인 카테고리: "메뉴 준비 중" 메시지 표시
- 메뉴 데이터 로딩 실패: 재시도 버튼 표시
- 관리자 미지정 시 인기 배지 미표시

**UI Hints:**
- 상단 카테고리 탭 바 (가로 스크롤)
- 메뉴 카드: 이미지 + 메뉴명 + 가격 + 인기 배지 (해당 시)
- 박영숙(기술 미숙) 고려: 큰 글씨, 명확한 가격 표시

---

## US-4: 메뉴 관리 (CRUD) [Should]
**As a** 관리자 (이민호),
**I want** 메뉴를 등록/수정/삭제하고 노출 순서를 조정할 수 있기를,
**So that** 매장 상황에 맞게 메뉴를 관리할 수 있다.

**Acceptance Criteria:**
- 메뉴 등록: 메뉴명, 가격, 설명, 카테고리, 이미지 URL, 인기 메뉴 여부, 품절 여부 입력
- 메뉴 수정: 기존 정보 수정 가능
- 메뉴 삭제: 삭제 확인 후 제거
- 메뉴 노출 순서 조정 (드래그 또는 순서 번호)
- 필수 필드 검증 (메뉴명, 가격, 카테고리)
- 가격 범위 검증 (0원 초과)

**Scenarios:**
```
Given 메뉴 관리 화면에서
When 새 메뉴 정보를 입력하고 저장하면
Then 메뉴가 등록되고 고객 화면에 반영된다
```
```
Given 필수 필드를 비워둔 채
When 저장을 시도하면
Then 필수 필드 오류 메시지가 표시된다
```
```
Given 메뉴 목록에서
When 메뉴 순서를 변경하면
Then 고객 화면의 메뉴 표시 순서가 변경된다
```

**Edge Cases:**
- 가격에 음수 또는 0 입력: 검증 오류 표시
- 이미지 URL이 유효하지 않은 경우: 저장은 허용, 고객 화면에서 placeholder 표시
- 주문에 포함된 메뉴 삭제: 기존 주문에는 영향 없음 (주문 시점 데이터 유지)

**UI Hints:**
- 메뉴 목록 테이블 + 등록/수정 모달 또는 폼
- 순서 조정: 드래그 앤 드롭 또는 ↑↓ 버튼

---

# Domain: 주문 (Order)

## US-5: 장바구니 관리 [Must]
**As a** 고객 (김지수/박영숙),
**I want** 메뉴를 장바구니에 담고 수량을 조절할 수 있기를,
**So that** 주문 전에 원하는 메뉴를 정리할 수 있다.

**Acceptance Criteria:**
- 메뉴 추가/삭제
- 수량 조절 (증가/감소, 최소 1)
- 총 금액 실시간 계산
- 장바구니 비우기 (수동)
- 클라이언트 로컬 저장 (새로고침 시 유지)
- 서버 전송은 주문 확정 시에만

**Scenarios:**
```
Given 메뉴 상세 화면에서
When "담기" 버튼을 터치하면
Then 해당 메뉴가 장바구니에 추가되고 총 금액이 업데이트된다
```
```
Given 장바구니에 메뉴가 있을 때
When 수량 "-" 버튼을 눌러 0이 되면
Then 해당 메뉴가 장바구니에서 제거된다
```
```
Given 장바구니에 메뉴가 있을 때
When 브라우저를 새로고침하면
Then 장바구니 내용이 유지된다
```
```
Given 장바구니에 메뉴가 있을 때
When "장바구니 비우기" 버튼을 터치하면
Then 모든 메뉴가 제거되고 총 금액이 0원이 된다
```

**Edge Cases:**
- 장바구니에 담긴 메뉴가 관리자에 의해 삭제된 경우: 주문 확정 시 서버에서 검증, 에러 표시
- 로컬 스토리지 용량 초과: 가능성 낮으나 에러 핸들링

**UI Hints:**
- 하단 고정 장바구니 바 (메뉴 수, 총 금액 표시)
- 수량 조절: - / 수량 / + 버튼
- 박영숙 고려: 큰 +/- 버튼, 명확한 금액 표시

---

## US-6: 주문 생성 [Must]
**As a** 고객 (김지수/박영숙),
**I want** 장바구니의 메뉴를 확인하고 주문을 확정할 수 있기를,
**So that** 원하는 메뉴를 정확하게 주문할 수 있다.

**Acceptance Criteria:**
- 주문 내역 최종 확인 화면 표시
- 주문 확정 버튼
- 성공 시: 주문 번호 5초 표시 → 장바구니 비우기 → 메뉴 화면 자동 리다이렉트
- 실패 시: 에러 메시지 표시, 장바구니 유지
- 주문 정보: 매장 ID, 테이블 ID, 메뉴 목록 (메뉴명, 수량, 단가), 총 금액, 세션 ID

**Scenarios:**
```
Given 장바구니에 메뉴가 있을 때
When "주문하기" 버튼을 터치하면
Then 주문 확인 화면이 표시된다 (메뉴 목록, 수량, 단가, 총 금액)
```
```
Given 주문 확인 화면에서
When "주문 확정" 버튼을 터치하면
Then 주문이 생성되고 주문 번호가 5초간 표시된 후 메뉴 화면으로 이동한다
```
```
Given 서버 오류로 주문이 실패했을 때
When 주문 확정을 시도하면
Then 에러 메시지가 표시되고 장바구니는 유지된다
```

**Edge Cases:**
- 빈 장바구니로 주문 시도: 주문 버튼 비활성화
- 주문 중 네트워크 끊김: 에러 표시, 재시도 가능
- 동일 테이블에서 동시 주문 (다른 탭): 서버에서 순차 처리

**UI Hints:**
- 주문 확인: 메뉴별 이름/수량/금액 리스트 + 총 금액
- 주문 성공: 체크마크 애니메이션 + 주문 번호 크게 표시
- 박영숙 고려: "주문 확정" 버튼 크고 명확하게

---

## US-7: 주문 내역 조회 [Must]
**As a** 고객 (김지수/박영숙),
**I want** 현재 테이블에서 주문한 내역과 상태를 확인할 수 있기를,
**So that** 주문이 제대로 접수되었는지 확인할 수 있다.

**Acceptance Criteria:**
- 현재 테이블 세션 주문만 표시 (이용 완료 처리된 주문 제외)
- 주문 시간 순 정렬
- 주문별: 주문 번호, 시각, 메뉴/수량, 금액, 상태 (대기중/준비중/완료)
- 주문 상태 실시간 업데이트 (SSE)
- 페이지네이션 또는 무한 스크롤

**Scenarios:**
```
Given 주문 내역 화면에서
When 주문 목록을 조회하면
Then 현재 세션의 주문만 시간순으로 표시된다
```
```
Given 주문 상태가 "대기중"인 주문이 있을 때
When 관리자가 상태를 "준비중"으로 변경하면
Then 고객 화면에서 실시간으로 상태가 업데이트된다
```

**Edge Cases:**
- 세션 내 주문이 0건: "주문 내역이 없습니다" 메시지
- SSE 연결 끊김: 자동 재연결 시도, 실패 시 수동 새로고침 안내

**UI Hints:**
- 주문 카드 리스트 (주문 번호, 시각, 상태 배지)
- 상태별 색상: 대기중(노랑), 준비중(파랑), 완료(초록)
- 박영숙 고려: 상태를 텍스트 + 색상으로 이중 표시

---

## US-8: 실시간 주문 모니터링 [Must]
**As a** 관리자 (이민호),
**I want** 들어오는 주문을 실시간으로 테이블별로 확인하고 상태를 변경할 수 있기를,
**So that** 주문을 놓치지 않고 빠르게 처리할 수 있다.

**Acceptance Criteria:**
- SSE 기반 실시간 주문 목록 업데이트
- 테이블별 그리드/카드 레이아웃
- 각 카드: 총 주문액, 최신 주문 미리보기 (테이블 번호, 주문 번호, 주문 시각, 메뉴/수량 축약, 총 금액)
- 카드 클릭 시 전체 메뉴 목록 상세 보기
- 주문 상태 변경 (대기중 → 준비중 → 완료)
- 신규 주문 시각적 강조 (색상 변경, 애니메이션)
- 2초 이내 주문 표시
- 테이블별 필터링 기능

**Scenarios:**
```
Given 주문 모니터링 대시보드에서
When 고객이 새 주문을 생성하면
Then 2초 이내에 해당 테이블 카드에 주문이 표시되고 시각적으로 강조된다
```
```
Given 테이블 카드에서
When 주문 상태를 "준비중"으로 변경하면
Then 상태가 즉시 업데이트되고 고객 화면에도 반영된다
```
```
Given 테이블 필터를 선택했을 때
When 특정 테이블을 선택하면
Then 해당 테이블의 주문만 표시된다
```

**Edge Cases:**
- SSE 연결 끊김: 자동 재연결, 재연결 시 누락 주문 동기화
- 동시에 여러 주문 수신: 순차적으로 표시, 모두 강조
- 테이블 카드가 많을 때: 스크롤 또는 페이지 분할

**UI Hints:**
- 그리드 레이아웃 (반응형, 화면 크기에 따라 열 수 조정)
- 신규 주문: 카드 테두리 강조 + 펄스 애니메이션
- 상태 변경: 드롭다운 또는 버튼 (대기중→준비중→완료)

---

## US-9: 일매출 정산 [Should]
**As a** 관리자 (이민호),
**I want** 당일 및 날짜별 매출을 확인할 수 있기를,
**So that** 매장 매출 현황을 파악하고 정산할 수 있다.

**Acceptance Criteria:**
- 당일 총 매출액 표시 (완료된 주문 기준)
- 날짜별 매출 조회 (날짜 선택)
- 테이블별 매출 내역 표시

**Scenarios:**
```
Given 정산 화면에 진입했을 때
When 당일 매출을 조회하면
Then 완료된 주문 기준 총 매출액과 테이블별 내역이 표시된다
```
```
Given 정산 화면에서
When 특정 날짜를 선택하면
Then 해당 날짜의 매출 내역이 표시된다
```

**Edge Cases:**
- 해당 날짜에 주문이 0건: "매출 내역이 없습니다" 메시지
- 삭제된 주문: 매출 집계에서 제외

**UI Hints:**
- 상단: 날짜 선택 (date picker) + 총 매출액 크게 표시
- 하단: 테이블별 매출 리스트 (테이블 번호, 주문 건수, 금액)

---

# Domain: 테이블 관리 (Table Management)

## US-10: 테이블 초기 설정 [Must]
**As a** 관리자 (이민호),
**I want** 테이블 태블릿의 번호와 비밀번호를 설정할 수 있기를,
**So that** 고객이 해당 테이블에서 자동 로그인하여 주문할 수 있다.

**Acceptance Criteria:**
- 테이블 번호 및 비밀번호 설정
- 16시간 세션 생성
- 설정 완료 후 태블릿에서 자동 로그인 활성화

**Scenarios:**
```
Given 관리자 화면에서 테이블 설정을 선택했을 때
When 테이블 번호와 비밀번호를 입력하고 저장하면
Then 해당 테이블의 태블릿에서 자동 로그인이 가능해진다
```

**Edge Cases:**
- 이미 존재하는 테이블 번호 입력: 중복 오류 표시
- 비밀번호 미입력: 필수 필드 검증 오류

**UI Hints:**
- 테이블 번호 입력 + 비밀번호 입력 폼
- 저장 성공 시 확인 메시지

---

## US-11: 주문 삭제 [Must]
**As a** 관리자 (이민호),
**I want** 잘못된 주문을 삭제할 수 있기를,
**So that** 테이블 주문 현황을 정확하게 유지할 수 있다.

**Acceptance Criteria:**
- 특정 주문 삭제 버튼
- 확인 팝업 표시
- 삭제 후 테이블 총 주문액 재계산
- 성공/실패 피드백

**Scenarios:**
```
Given 테이블 상세에서 주문 목록을 볼 때
When "삭제" 버튼을 클릭하면
Then 확인 팝업이 표시된다
```
```
Given 확인 팝업에서
When "확인"을 클릭하면
Then 주문이 삭제되고 총 주문액이 재계산되며 성공 메시지가 표시된다
```
```
Given 확인 팝업에서
When "취소"를 클릭하면
Then 팝업이 닫히고 주문은 유지된다
```

**Edge Cases:**
- 이미 "완료" 상태인 주문 삭제: 허용 (관리자 직권)
- 삭제 중 네트워크 오류: 실패 메시지 표시, 재시도 가능

**UI Hints:**
- 주문 항목 옆 삭제 아이콘/버튼
- 확인 팝업: "이 주문을 삭제하시겠습니까?" + 주문 요약 표시

---

## US-12: 테이블 세션 종료 (이용 완료) [Must]
**As a** 관리자 (이민호),
**I want** 고객 퇴장 시 테이블 세션을 종료할 수 있기를,
**So that** 다음 고객이 깨끗한 상태에서 시작할 수 있다.

**Acceptance Criteria:**
- 확인 팝업 표시
- 현재 세션 주문 내역 → 과거 이력 (OrderHistory)으로 이동
- 테이블 현재 주문 목록 및 총 주문액 0으로 리셋
- 세션 종료 후 새 고객은 이전 주문 내역 없이 깨끗한 상태에서 시작
- 테이블 세션 시작: 해당 테이블의 첫 주문 시점에 자동 시작
- 세션 ID로 주문 그룹화, 완료 시각 기록
- 성공/실패 피드백

**Scenarios:**
```
Given 테이블에 활성 세션이 있을 때
When "이용 완료" 버튼을 클릭하면
Then 확인 팝업이 표시된다
```
```
Given 확인 팝업에서 "확인"을 클릭하면
When 세션이 종료되면
Then 주문 내역이 과거 이력으로 이동하고 테이블이 리셋되며 성공 메시지가 표시된다
```
```
Given 세션이 종료된 테이블에서
When 새 고객이 첫 주문을 하면
Then 새로운 세션이 자동 시작된다
```

**Edge Cases:**
- "대기중" 주문이 남아있는 상태에서 이용 완료: 확인 팝업에 경고 표시
- 이용 완료 처리 중 네트워크 오류: 실패 메시지, 재시도 가능

**UI Hints:**
- "이용 완료" 버튼 (테이블 카드 또는 상세 화면)
- 확인 팝업: 총 주문액 요약 + "정말 이용 완료 처리하시겠습니까?"

---

## US-13: 과거 주문 내역 조회 [Should]
**As a** 관리자 (이민호),
**I want** 테이블별 과거 주문 내역을 조회할 수 있기를,
**So that** 이전 매출과 주문 이력을 확인할 수 있다.

**Acceptance Criteria:**
- 테이블별 과거 주문 목록 표시 (시간 역순)
- 각 주문: 주문 번호, 시각, 메뉴 목록, 총 금액, 매장 이용 완료 시각
- 날짜 필터링 기능
- "닫기" 버튼으로 대시보드 복귀

**Scenarios:**
```
Given 테이블 상세에서
When "과거 내역" 영역을 조회하면
Then 해당 테이블의 과거 주문이 시간 역순으로 표시된다
```
```
Given 과거 내역 화면에서
When 날짜 필터를 설정하면
Then 해당 날짜 범위의 주문만 표시된다
```
```
Given 과거 내역 화면에서
When "닫기" 버튼을 클릭하면
Then 대시보드로 복귀한다
```

**Edge Cases:**
- 과거 내역이 0건: "과거 주문 내역이 없습니다" 메시지
- 대량 데이터: 페이지네이션 적용

**UI Hints:**
- 주문 리스트 (주문 번호, 시각, 금액, 이용 완료 시각)
- 상단 날짜 필터 (date picker)
- 하단 또는 상단 "닫기" 버튼
